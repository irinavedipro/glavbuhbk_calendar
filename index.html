<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>БК Главбух: Календарь 2026</title>
    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        body { 
            font-family: 'Inter', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
            background-color: #f8f3f0;
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-up { animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, 20px); }
            15% { opacity: 1; transform: translate(-50%, 0); }
            85% { opacity: 1; transform: translate(-50%, 0); }
            100% { opacity: 0; transform: translate(-50%, -20px); }
        }
        .toast {
            position: fixed;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: #2d2d2d;
            color: white;
            padding: 14px 28px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            z-index: 1000;
            white-space: nowrap;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);
            animation: fadeInOut 3s forwards;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useRef, useEffect } = React;

        const tg = window.Telegram?.WebApp;

        // --- ОПРЕДЕЛЕНИЕ ИКОНОК ---
        const LogoIcon = () => (
            <svg width="44" height="44" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="32" r="18" fill="#1a1a1a" />
                <path d="M10 52 C 10 88, 90 88, 90 52 H 10 Z" fill="#c05a36" />
            </svg>
        );

        const ShieldIcon = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
        );

        const ChevronIcon = ({ side }) => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className={side === 'left' ? 'rotate-180' : ''}>
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        );

        const CloseIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const CalendarIcon = () => (
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const Pattern = ({ type }) => {
            if (type === 1) return <svg className="absolute inset-0 w-full h-full opacity-30" viewBox="0 0 100 150" preserveAspectRatio="xMidYMid slice"><path d="M0 150 A 50 50 0 0 1 100 150" fill="#c05a36" /><circle cx="50" cy="80" r="20" fill="#1a1a1a" /></svg>;
            if (type === 2) return <svg className="absolute inset-0 w-full h-full opacity-30" viewBox="0 0 100 150" preserveAspectRatio="xMidYMid slice"><circle cx="50" cy="0" r="60" fill="none" stroke="#c05a36" strokeWidth="15" /><circle cx="50" cy="0" r="30" fill="none" stroke="#1a1a1a" strokeWidth="10" /></svg>;
            return <svg className="absolute inset-0 w-full h-full opacity-25" viewBox="0 0 100 150" preserveAspectRatio="xMidYMid slice"><rect x="0" y="75" width="100" height="75" fill="#c05a36" /><circle cx="50" cy="75" r="35" fill="#1a1a1a" /></svg>;
        };

        // --- ИСЧЕРПЫВАЮЩАЯ БАЗА СОБЫТИЙ 2026 (ЯНВАРЬ - ДЕКАБРЬ) ---
        const taxCalendarData = {
            0: [ // январь
                { id: 'j1', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "Страховые взносы в СФР за декабрь 2025 года.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'j2', date: 26, type: 'платеж', title: "Налог по АвтоУСН", desc: "Налог за декабрь 2025 года.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'j3', date: 26, type: 'отчетность', title: "НДС и РСВ", desc: "Декларация НДС за 4 кв 2025 года и РСВ за весь 2025 год.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'ЕСХН', 'УСН'] },
                { id: 'j4', date: 26, type: 'отчетность', title: "ЕФС-1", desc: "Сведения о стаже и взносах на травматизм за 2025 год.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН', 'ПСН'] },
                { id: 'j5', date: 28, type: 'платеж', title: "ЕНП (НДФЛ, Взносы, НДС)", desc: "НДФЛ за 1–22 янв, взносы в ФНС за дек, 1/3 НДС за 4 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'j6', date: 28, type: 'платеж', title: "НПД", desc: "За декабрь 2025 года.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] },
                { id: 'j7', date: 28, type: 'платеж', title: "Туристический налог", desc: "За 4 квартал 2025 года.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН'] }
            ],
            1: [ // февраль
                { id: 'f1', date: 5, type: 'платеж', title: "НДФЛ (23–31 янв)", desc: "Налог за вторую половину января.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'f2', date: 16, type: 'платеж', title: "Взносы на травматизм", desc: "За январь 2026 года.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'f3', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За январь.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'f4', date: 25, type: 'отчетность', title: "6-НДФЛ за 2025 год", desc: "Итоговый расчет за прошлый год.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'f5', date: 25, type: 'отчетность', title: "Персонифицированные сведения", desc: "О физических лицах за январь.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН', 'ПСН'] },
                { id: 'f6', date: 28, type: 'платеж', title: "ЕНП / Имущ. налоги", desc: "НДФЛ (1–22 фев), взносы, имущество, транспорт, земля организаций за 2025 год.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'f7', date: 28, type: 'платеж', title: "НПД", desc: "За январь.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] }
            ],
            2: [ // март
                { id: 'm1', date: 5, type: 'платеж', title: "НДФЛ (23–28 фев)", desc: "Налог за вторую половину февраля.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'm2', date: 16, type: 'платеж', title: "Взносы на травматизм", desc: "За февраль.", org: ['ООО', 'IP'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'm3', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За февраль.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'm4', date: 25, type: 'отчетность', title: "Декларация УСН (ООО)", desc: "За 2025 год для организаций.", org: ['ООО'], sys: ['УСН'] },
                { id: 'm5', date: 25, type: 'отчетность', title: "Декларация ЕСХН / Прибыль", desc: "За 2025 год.", org: ['ООО', 'ИП'], sys: ['ЕСХН', 'ОСНО'] },
                { id: 'm6', date: 30, type: 'платеж', title: "УСН / ЕСХН / Прибыль (год)", desc: "Уплата налогов за 2025 год.", org: ['ООО'], sys: ['УСН', 'ЕСХН', 'ОСНО'] },
                { id: 'm7', date: 30, type: 'платеж', title: "ЕНП", desc: "НДФЛ (1–22 мар), взносы, 1/3 НДС за 4 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'm8', date: 30, type: 'платеж', title: "НПД", desc: "За февраль.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] }
            ],
            3: [ // апрель
                { id: 'a1', date: 6, type: 'платеж', title: "НДФЛ (23–31 мар)", desc: "Налог за конец марта.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'a2', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "За март.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'a3', date: 27, type: 'платеж', title: "Налог по АвтоУСН", desc: "За март.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'a4', date: 27, type: 'отчетность', title: "НДС / УСН (ИП) / РСВ", desc: "НДС за 1 кв, УСН для ИП за год, РСВ и 6-НДФЛ за 1 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН', 'ПСН'] },
                { id: 'a5', date: 28, type: 'платеж', title: "Аванс УСН (1 кв) / ЕНП", desc: "Платеж за 1 квартал 2026. НДФЛ за 1–22 апр.", org: ['ООО', 'ИП'], sys: ['УСН', 'ОСНО', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'a6', date: 28, type: 'платеж', title: "НДФЛ ИП (ОСНО)", desc: "Аванс за 1 квартал для предпринимателей на общем режиме.", org: ['ИП'], sys: ['ОСНО'] },
                { id: 'a7', date: 28, type: 'платеж', title: "УСН (ИП) за год", desc: "Единый налог за 2025 год для предпринимателей.", org: ['ИП'], sys: ['УСН'] },
                { id: 'a8', date: 28, type: 'платеж', title: "НПД / Тур. налог", desc: "НПД за март, Тур. налог за 1 кв.", org: ['ООО', 'ИП', 'Самозанятый'], sys: ['НПД', 'ОСНО', 'УСН'] }
            ],
            4: [ // май
                { id: 'ma1', date: 5, type: 'платеж', title: "НДФЛ (23–30 апр)", desc: "Налог за конец апреля.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'ma2', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "За апрель.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'ma3', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За апрель.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'ma4', date: 28, type: 'платеж', title: "Уплата ЕНП", desc: "НДФЛ (1–22 мая), взносы за апр, 1/3 НДС за 1 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'ma5', date: 28, type: 'платеж', title: "НПД", desc: "За апрель.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] }
            ],
            5: [ // июнь
                { id: 'ju1', date: 5, type: 'платеж', title: "НДФЛ (23–31 мая)", desc: "Налог за конец мая.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'ju2', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "За май.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'ju3', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За май.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'ju4', date: 29, type: 'платеж', title: "Уплата ЕНП", desc: "НДФЛ (1–22 июн), взносы за май, 1/3 НДС за 1 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'ju5', date: 29, type: 'платеж', title: "НПД", desc: "За май.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] }
            ],
            6: [ // июль
                { id: 'jl1', date: 1, type: 'платеж', title: "Допвзносы ИП (1%)", desc: "С доходов свыше 300 000 руб. за 2025 год.", org: ['ИП'], sys: ['ОСНО', 'УСН', 'ПСН', 'ЕСХН'] },
                { id: 'jl2', date: 6, type: 'платеж', title: "НДФЛ (23–30 июн)", desc: "За конец июня.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'jl3', date: 15, type: 'платеж', title: "НДФЛ ИП за 2025", desc: "Итоговый платеж за прошлый год для ИП на ОСНО.", org: ['ИП'], sys: ['ОСНО'] },
                { id: 'jl4', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "За июнь.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'jl5', date: 27, type: 'отчетность', title: "НДС / РСВ / 6-НДФЛ (2 кв)", desc: "Квартальная отчетность за полугодие.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН', 'ПСН'] },
                { id: 'jl6', date: 28, type: 'платеж', title: "Авансы (полугодие)", desc: "УСН, ЕСХН, налог на прибыль, имущество, НДФЛ ИП.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'jl7', date: 28, type: 'платеж', title: "НПД / Тур. налог", desc: "За июнь и 2 квартал соответственно.", org: ['ООО', 'ИП', 'Самозанятый'], sys: ['НПД', 'ОСНО', 'УСН'] }
            ],
            7: [ // август
                { id: 'au1', date: 5, type: 'платеж', title: "НДФЛ (23–31 июл)", desc: "За вторую половину июля.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'au2', date: 17, type: 'платеж', title: "Взносы на травматизм", desc: "За июль.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'au3', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За июль.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'au4', date: 28, type: 'платеж', title: "Уплата ЕНП", desc: "НДФЛ (1–22 авг), взносы за июль, 1/3 НДС за 2 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'au5', date: 28, type: 'платеж', title: "НПД", desc: "За июль.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] }
            ],
            8: [ // сентябрь
                { id: 'se1', date: 7, type: 'платеж', title: "НДФЛ (23–31 авг)", desc: "За конец августа.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'se2', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "За август.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'se3', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За август.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'se4', date: 28, type: 'платеж', title: "Уплата ЕНП", desc: "НДФЛ (1–22 сен), взносы за август, 1/3 НДС за 2 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'se5', date: 28, type: 'платеж', title: "НПД", desc: "За август.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] }
            ],
            9: [ // октябрь
                { id: 'oc1', date: 5, type: 'платеж', title: "НДФЛ (23–30 сен)", desc: "За конец сентября.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'oc2', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "За сентябрь.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'oc3', date: 26, type: 'платеж', title: "Налог по АвтоУСН", desc: "За сентябрь.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'oc4', date: 26, type: 'отчетность', title: "НДС / РСВ / 6-НДФЛ (3 кв)", desc: "Отчетность за 9 месяцев 2026 года.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН', 'ПСН'] },
                { id: 'oc5', date: 28, type: 'платеж', title: "Авансы (9 мес)", desc: "УСН, налог на прибыль, имущество, НДФЛ ИП (ОСНО).", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'oc6', date: 28, type: 'платеж', title: "НПД / Тур. налог", desc: "За сентябрь и 3 квартал соответственно.", org: ['ООО', 'ИП', 'Самозанятый'], sys: ['НПД', 'ОСНО', 'УСН'] }
            ],
            10: [ // ноябрь
                { id: 'no1', date: 5, type: 'платеж', title: "НДФЛ (23–31 окт)", desc: "За конец октября.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'no2', date: 16, type: 'платеж', title: "Взносы на травматизм", desc: "За октябрь.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'no3', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За октябрь.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'no4', date: 30, type: 'платеж', title: "Уплата ЕНП", desc: "НДФЛ (1–22 ноя), взносы за октябрь, 1/3 НДС за 3 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'no5', date: 30, type: 'платеж', title: "НПД", desc: "За октябрь.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] }
            ],
            11: [ // декабрь
                { id: 'de1', date: 1, type: 'платеж', title: "Имущ. налоги ИП", desc: "Транспортный, земельный, на имущество физлиц за 2025 год.", org: ['ИП'], sys: ['ОСНО', 'УСН', 'ПСН', 'ЕСХН'] },
                { id: 'de2', date: 7, type: 'платеж', title: "НДФЛ (23–30 ноя)", desc: "За конец ноября.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] },
                { id: 'de3', date: 15, type: 'платеж', title: "Взносы на травматизм", desc: "За ноябрь.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ПСН', 'ЕСХН'] },
                { id: 'de4', date: 25, type: 'платеж', title: "Налог по АвтоУСН", desc: "За ноябрь.", org: ['ООО', 'ИП'], sys: ['АУСН'] },
                { id: 'de5', date: 28, type: 'платеж', title: "Фикс. взносы ИП за 2026", desc: "Обязательные взносы ИП за себя за 2026 год.", org: ['ИП'], sys: ['ОСНО', 'УСН', 'ПСН', 'ЕСХН'] },
                { id: 'de6', date: 28, type: 'платеж', title: "Патент (ИП)", desc: "Оплата патентов со сроком до 31.12.2026.", org: ['ИП'], sys: ['ПСН'] },
                { id: 'de7', date: 28, type: 'платеж', title: "Уплата по ЕНП", desc: "НДФЛ (1–22 дек), взносы за ноя, 1/3 НДС за 3 кв.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'АУСН', 'ЕСХН', 'ПСН'] },
                { id: 'de8', date: 28, type: 'платеж', title: "НПД", desc: "За ноябрь.", org: ['ИП', 'Самозанятый'], sys: ['НПД'] },
                { id: 'de9', date: 31, type: 'платеж', title: "НДФЛ (23–31 дек)", desc: "Итоговый платеж НДФЛ за год.", org: ['ООО', 'ИП'], sys: ['ОСНО', 'УСН', 'ЕСХН'] }
            ]
        };

        const months = ["январь", "февраль", "март", "апрель", "май", "июнь", "июль", "август", "сентябрь", "октябрь", "ноябрь", "декабрь"];

        // База знаний с ТРИГГЕРАМИ ДЛЯ БОТА
        const materials = [
            { id: 1, title: 'КРАШ ТЕСТ бизнеса', type: 'интерактив', pattern: 1, trigger: 'crash' },
            { id: 2, title: '1С-гороскоп', type: 'бот', pattern: 2, trigger: 'horoscope' },
            { id: 3, title: 'Вычет через работу', type: 'чек-лист', pattern: 3, trigger: 'vychet' },
            { id: 4, title: 'Работа с самозанятыми', type: 'чек-лист', pattern: 1, trigger: 'samozanyat' },
            { id: 5, title: 'План изменений 2026', type: 'план', pattern: 2, trigger: 'plan' },
            { id: 6, title: 'Схема НДС 2026', type: 'схема', pattern: 3, trigger: 'nds1' },
            { id: 7, title: 'НДС в 1С: розница', type: 'гайд', pattern: 1, trigger: 'nds2' }
        ];

        function App() {
            const [selectedMonth, setSelectedMonth] = useState(1);
            const [filterOrg, setFilterOrg] = useState('Все');
            const [filterSys, setFilterSys] = useState('Все');
            const [expandedId, setExpandedId] = useState(null);
            const [toast, setToast] = useState(null);
            const scrollRef = useRef(null);

            useEffect(() => {
                if (tg) {
                    tg.ready();
                    tg.expand();
                }
            }, []);

            const currentEvents = useMemo(() => {
                const events = taxCalendarData[selectedMonth] || [];
                return events.filter(e => (filterOrg === 'Все' || e.org.includes(filterOrg)) && (filterSys === 'Все' || e.sys.includes(filterSys)));
            }, [selectedMonth, filterOrg, filterSys]);

            const showToast = (text) => {
                setToast(text);
                setTimeout(() => setToast(null), 3000);
            };

            const handleMaterialClick = (trigger) => {
                showToast('Материал отправлен в чат бот');
                // Прямая отправка команды боту (параметр запуска)
                const botUrl = `https://t.me/bk_glavbuh_helper_bot?start=${trigger}`;
                if (tg && tg.openTelegramLink) {
                    tg.openTelegramLink(botUrl);
                } else {
                    window.open(botUrl, '_blank');
                }
            };

            const scroll = (dir) => {
                if (scrollRef.current) {
                    const { scrollLeft } = scrollRef.current;
                    scrollRef.current.scrollTo({ left: dir === 'left' ? scrollLeft - 220 : scrollLeft + 220, behavior: 'smooth' });
                }
            };

            return (
                <div className="max-w-md mx-auto min-h-screen pb-44 shadow-2xl bg-[#f8f3f0] relative">
                    {/* Header */}
                    <header className="bg-white p-6 rounded-b-[44px] shadow-sm border-b border-orange-50 sticky top-0 z-30">
                        <div className="flex items-center justify-between mb-6">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-white border border-gray-100 rounded-xl flex items-center justify-center shadow-sm overflow-hidden"><LogoIcon /></div>
                                <span className="font-extrabold tracking-tight text-gray-800 uppercase text-[11px]">БК Главбух</span>
                            </div>
                            <button onClick={() => tg?.close()} className="p-2 text-gray-400 hover:text-orange-600 transition-colors bg-gray-50 rounded-full"><CloseIcon /></button>
                        </div>
                        <h1 className="text-2xl font-black mb-6 leading-tight text-gray-900 text-center uppercase tracking-tight">Календарь 2026</h1>
                        <div className="flex flex-wrap gap-2 mb-4 justify-center">
                            {['Все', 'ООО', 'ИП', 'Самозанятый'].map(v => (<button key={v} onClick={() => { setFilterOrg(v); setExpandedId(null); }} className={`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${filterOrg === v ? 'bg-black text-white shadow-lg scale-105' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}`}>{v}</button>))}
                        </div>
                        <div className="flex flex-wrap gap-2 justify-center">
                            {['Все', 'ОСНО', 'УСН', 'ПСН', 'НПД', 'АУСН', 'ЕСХН'].map(v => (<button key={v} onClick={() => { setFilterSys(v); setExpandedId(null); }} className={`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${filterSys === v ? 'bg-[#c05a36] text-white shadow-lg scale-105' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}`}>{v}</button>))}
                        </div>
                    </header>

                    {/* База знаний */}
                    <section className="px-4 mt-10 relative group">
                        <div className="flex items-center justify-between mb-5 px-2">
                            <h3 className="font-black text-gray-900 uppercase text-[11px] tracking-widest">База знаний</h3>
                            <div className="flex gap-2">
                                <button onClick={() => scroll('left')} className="w-8 h-8 bg-white border border-gray-100 shadow-sm rounded-full flex items-center justify-center text-gray-600 hover:text-black focus:outline-none"><ChevronIcon side="left" /></button>
                                <button onClick={() => scroll('right')} className="w-8 h-8 bg-white border border-gray-100 shadow-sm rounded-full flex items-center justify-center text-gray-600 hover:text-black focus:outline-none"><ChevronIcon side="right" /></button>
                            </div>
                        </div>
                        <div ref={scrollRef} className="flex overflow-x-auto hide-scrollbar gap-4 pb-4 px-2 snap-x">
                            {materials.map(m => (
                                <div key={m.id} onClick={() => handleMaterialClick(m.trigger)} className="flex-shrink-0 w-[145px] h-[195px] bg-white rounded-[36px] p-6 flex flex-col justify-between shadow-md border border-white hover:border-orange-100 transition-all active:scale-95 snap-start relative overflow-hidden group cursor-pointer">
                                    <div className="z-0"><Pattern type={m.pattern} /></div>
                                    <div className="relative z-10 w-9 h-9 rounded-full bg-white/90 backdrop-blur shadow-sm flex items-center justify-center"><div className="w-3 h-3 bg-[#c05a36] rounded-full"></div></div>
                                    <div className="relative z-10"><span className="text-[9px] font-black text-[#c05a36] uppercase tracking-tighter mb-1 block">{m.type}</span><p className="text-[12px] font-bold leading-tight text-gray-900">{m.title}</p></div>
                                </div>
                            ))}
                        </div>
                        <p className="text-[10px] text-gray-400 mt-2 text-center font-bold uppercase tracking-widest">Смахните вправо →</p>
                    </section>

                    {/* Навигация по месяцам */}
                    <div className="mt-8 px-4 relative overflow-visible">
                        <nav className="flex overflow-x-auto hide-scrollbar gap-4 py-10 items-center min-h-[120px]">
                            {months.map((m, i) => (<button key={m} onClick={() => { setSelectedMonth(i); setExpandedId(null); }} className={`px-8 py-4 rounded-full text-[11px] font-black uppercase tracking-widest flex-shrink-0 transition-all ${selectedMonth === i ? 'bg-black text-white shadow-2xl scale-110 z-10' : 'bg-white text-gray-400 border border-transparent shadow-sm hover:border-gray-200'}`}>{m}</button>))}
                        </nav>
                    </div>

                    {/* Список событий */}
                    <main className="px-4 mt-2 space-y-4">
                        {currentEvents.length > 0 ? currentEvents.map(e => (
                            <div key={e.id} className="bg-white rounded-[32px] p-6 shadow-sm border border-white hover:shadow-md transition-all animate-up" onClick={() => setExpandedId(expandedId === e.id ? null : e.id)}>
                                <div className="flex justify-between items-center mb-3">
                                    <span className="text-[10px] font-black text-[#c05a36] uppercase tracking-widest bg-orange-50 px-3 py-1 rounded-lg">{e.type}</span>
                                    <span className="text-[11px] font-bold text-gray-400">{e.date} {months[selectedMonth]}</span>
                                </div>
                                <h4 className="font-bold text-[15px] text-gray-900 leading-snug">{e.title}</h4>
                                {expandedId === e.id && <p className="mt-4 text-[13px] text-gray-600 leading-relaxed border-t border-gray-50 pt-4 whitespace-pre-line">{e.desc}</p>}
                            </div>
                        )) : <div className="text-center py-20 opacity-30"><p className="text-xs font-black text-gray-400 uppercase tracking-widest text-center">Событий нет</p></div>}
                    </main>

                    {/* CTA Кнопка */}
                    <div className="fixed bottom-8 left-1/2 -translate-x-1/2 w-full px-6 max-w-md z-40">
                        <button onClick={() => tg?.openTelegramLink('https://t.me/glavbuhbk')} className="w-full bg-black text-white py-5 rounded-[28px] font-black uppercase tracking-[0.25em] text-[11px] shadow-2xl flex items-center justify-center gap-3 active:scale-95 transition-all"><ShieldIcon /> Налоговый аудит</button>
                    </div>
                    {toast && <div className="toast">{toast}</div>}
                </div>
            );
        }
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
